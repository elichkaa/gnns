GpuFreq=control_disabled
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
Restoring states from the checkpoint path at ./logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_20/checkpoints/epoch=51-step=14716.ckpt
/pfs/data6/home/ka/ka_stud/ka_ufszm/.cache/pypoetry/virtualenvs/gnns-tZ7_1okr-py3.11/lib/python3.11/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:566: The dirpath has changed from './logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_20/checkpoints' to './logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_21/checkpoints', therefore `best_model_score`, `kth_best_model_path`, `kth_value`, `last_model_path` and `best_k_models` won't be reloaded. Only `best_model_path` will be reloaded.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name    | Type       | Params | Mode  | FLOPs
-------------------------------------------------------
0 | graph_f | ModuleList | 656 K  | train | 0    
1 | node_g  | ModuleList | 658 K  | train | 0    
2 | fc      | MLP        | 10.3 K | train | 0    
-------------------------------------------------------
1.3 M     Trainable params
0         Non-trainable params
1.3 M     Total params
5.300     Total estimated model params size (MB)
19        Modules in train mode
0         Modules in eval mode
0         Total Flops
Restored all states from the checkpoint at ./logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_20/checkpoints/epoch=51-step=14716.ckpt
SLURM auto-requeueing enabled. Setting signal handlers.
/pfs/data6/home/ka/ka_stud/ka_ufszm/.cache/pypoetry/virtualenvs/gnns-tZ7_1okr-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/_pytree.py:21: `isinstance(treespec, LeafSpec)` is deprecated, use `isinstance(treespec, TreeSpec) and treespec.is_leaf()` instead.
/pfs/data6/home/ka/ka_stud/ka_ufszm/.cache/pypoetry/virtualenvs/gnns-tZ7_1okr-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/data.py:79: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
/pfs/data6/home/ka/ka_stud/ka_ufszm/.cache/pypoetry/virtualenvs/gnns-tZ7_1okr-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/data.py:79: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 23. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
Epoch 52, global step 14999: 'val_loss' reached 1.00539 (best 1.00539), saving model to './logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_21/checkpoints/epoch=52-step=14999.ckpt' as top 1
Epoch 53, global step 15282: 'val_loss' reached 1.00101 (best 1.00101), saving model to './logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_21/checkpoints/epoch=53-step=15282.ckpt' as top 1
Epoch 54, global step 15565: 'val_loss' was not in top 1
Epoch 55, global step 15848: 'val_loss' was not in top 1
Epoch 56, global step 16131: 'val_loss' reached 0.98691 (best 0.98691), saving model to './logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_21/checkpoints/epoch=56-step=16131.ckpt' as top 1
Epoch 57, global step 16414: 'val_loss' was not in top 1
Epoch 58, global step 16697: 'val_loss' was not in top 1
Epoch 59, global step 16980: 'val_loss' reached 0.97163 (best 0.97163), saving model to './logs_20news/dDGM_distilbert-base-uncased_k10_gat_euclidean_poolmean/version_21/checkpoints/epoch=59-step=16980.ckpt' as top 1
Epoch 60, global step 17263: 'val_loss' was not in top 1
Monitored metric val_acc did not improve in the last 10 records. Best score: 70.349. Signaling Trainer to stop.
Epoch 61, global step 17546: 'val_loss' was not in top 1
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
SLURM auto-requeueing enabled. Setting signal handlers.
/pfs/data6/home/ka/ka_stud/ka_ufszm/.cache/pypoetry/virtualenvs/gnns-tZ7_1okr-py3.11/lib/python3.11/site-packages/pytorch_lightning/utilities/data.py:79: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 12. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
